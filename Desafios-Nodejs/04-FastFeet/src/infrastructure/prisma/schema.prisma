datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum UserRole {
  admin
  deliveryman
}

enum OrderStatus {
  awaiting
  picked_up
  delivered
  returned
}

model User {
  id          String    @id @default(uuid())
  cpf         String    @unique
  password    String
  role        UserRole
  name        String
  latitude    Float?
  longitude   Float?
  orders      Order[]   @relation("DeliverymanOrders")
}

model Order {
  id            String      @id @default(uuid())
  recipientId   String
  deliverymanId String?
  status        OrderStatus @default(awaiting)
  photoUrl      String?
  createdAt     DateTime    @default(now())
  pickedUpAt    DateTime?
  deliveredAt   DateTime?
  returnedAt    DateTime?
  recipient     Recipient   @relation(fields: [recipientId], references: [id])
  deliveryman   User?       @relation("DeliverymanOrders", fields: [deliverymanId], references: [id])
  notifications Notification[]
}

model Recipient {
  id            String        @id @default(uuid())
  name          String
  cpf           String        @unique // Adicionado para autenticação
  password      String        // Adicionado para autenticação
  address       String
  latitude      Float
  longitude     Float
  orders        Order[]
  notifications Notification[]
}

model Notification {
  id          String    @id @default(uuid())
  recipientId String
  orderId     String
  message     String
  sentAt      DateTime  @default(now())
  recipient   Recipient @relation(fields: [recipientId], references: [id])
  order       Order     @relation(fields: [orderId], references: [id])
}